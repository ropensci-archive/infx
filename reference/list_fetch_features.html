<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>List and download feature data — list_features • infx</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="List and download feature data — list_features" />
<meta property="og:description" content="In openBIS, features are datasets that are treated differently from
generic datasets. Briefly put, tabular datasets where columns correspond
to features and rows to wells can be marked as feature datasets which makes
it possible to query openBIS for individual feature values for selected
wells instead of having to download the entire table for a plate. The
relevant object types for handling feature data are
FeatureVectorDatasetReference and FeatureVectorDatasetWellReference,
where the former represents feature data at plate level and the latter at
well level. The function list_features() can be used to enumerate
available features and fetch_features() will download feature data." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">infx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/infx-intro.html">Introduction to infx</a>
    </li>
    <li>
      <a href="../articles/json-class.html">JSON object handling</a>
    </li>
    <li>
      <a href="../articles/openbis-api.html">OpenBIS API coverage</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>List and download feature data</h1>
    
    <div class="hidden name"><code>list_fetch_features.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>In openBIS, features are datasets that are treated differently from
generic datasets. Briefly put, tabular datasets where columns correspond
to features and rows to wells can be marked as feature datasets which makes
it possible to query openBIS for individual feature values for selected
wells instead of having to download the entire table for a plate. The
relevant object types for handling feature data are
<code>FeatureVectorDatasetReference</code> and <code>FeatureVectorDatasetWellReference</code>,
where the former represents feature data at plate level and the latter at
well level. The function <code>list_features()</code> can be used to enumerate
available features and <code>fetch_features()</code> will download feature data.</p>
    </div>

    <pre class="usage"><span class='fu'>list_features</span>(<span class='no'>token</span>, <span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for FeatureVectorDatasetReference</span>
<span class='fu'>list_features</span>(<span class='no'>token</span>, <span class='no'>x</span>,
  <span class='kw'>wells</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for FeatureVectorDatasetWellReference</span>
<span class='fu'>list_features</span>(<span class='no'>token</span>, <span class='no'>x</span>, <span class='no'>...</span>)

<span class='fu'>list_feature_codes</span>(<span class='no'>token</span>, <span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for FeatureVectorDatasetReference</span>
<span class='fu'>list_feature_codes</span>(<span class='no'>token</span>, <span class='no'>x</span>,
  <span class='kw'>wells</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for FeatureVectorDatasetWellReference</span>
<span class='fu'>list_feature_codes</span>(<span class='no'>token</span>, <span class='no'>x</span>,
  <span class='no'>...</span>)

<span class='fu'>fetch_features</span>(<span class='no'>token</span>, <span class='no'>x</span>, <span class='kw'>feature_codes</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='no'>...</span>)

<span class='co'># S3 method for FeatureVectorDatasetReference</span>
<span class='fu'>fetch_features</span>(<span class='no'>token</span>, <span class='no'>x</span>,
  <span class='kw'>feature_codes</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>wells</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for FeatureVectorDatasetWellReference</span>
<span class='fu'>fetch_features</span>(<span class='no'>token</span>, <span class='no'>x</span>,
  <span class='kw'>feature_codes</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>token</th>
      <td><p>Login token as created by <code><a href='login.html'>login_openbis()</a></code>.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Object to specify the set of feature vector datasets of interest.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Generic compatibility. Extra arguments will be passed to
<code><a href='request.html'>make_request()</a></code>.</p></td>
    </tr>
    <tr>
      <th>wells</th>
      <td><p>Set of <code>WellPosition</code> objects used to limit the returned
feature data.</p></td>
    </tr>
    <tr>
      <th>feature_codes</th>
      <td><p>A character vector of feature codes or NA (all
available feature codes).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>list_feature_codes()</code> returns a character vector of feature codes,
while <code>list_features()</code> and <code>fetch_features()</code> return either <code><a href='json_class.html'>json_class</a></code>
(single object) or a <code><a href='json_vec.html'>json_vec</a></code> (multiple objects), dependent on the
number of resulting objects. The sub-type is <code>FeatureInformation</code> for
<code>list_features()</code> and <code>FeatureVectorDataset</code> for <code>fetch_features()</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Listing of features can be performed by calling <code>list_features()</code> on
<code>FeatureVectorDatasetReference</code> or <code>FeatureVectorDatasetWellReference</code>
objects. Plate-level references of feature datasets can for example be
retrieved using <code><a href='list_datasets.html'>list_references()</a></code> and well-level references are created
whenever a <code>wells</code> argument is supplied to <code>list_features()</code>, using the
internal function <code><a href='feat_ds_well_ref.html'>feat_ds_well_ref()</a></code>. The returned objects are of type
<code>FeatureInformation</code> and each contain code, label and description of each
feature. If for different datasets different sets of features are available,
<code>list_features()</code> provides the union of the features of all datasets.</p>
<p>Similarly, <code>list_feature_codes()</code> provides the list of all available
features as character vector of feature codes. As for <code>list_features()</code>,
either plate-level or well-level feature dataset reference may be passed
and if a <code>wells</code> argument is supplied together with a plate-level
reference, the corresponding well-level references are constructed using
the internal function <code><a href='feat_ds_well_ref.html'>feat_ds_well_ref()</a></code>. If for different datasets
different sets of features are available, <code>list_feature_codes()</code> provides
the union of the features of all datasets.</p>
<p>For a given set of feature vector datasets, <code>fetch_features()</code> fetches
feature data for the specified feature codes, or for all available features
in case the argument <code>feature_codes</code> is not specified (or <code>NA</code>). The
behavior regarding well selection is the same as in <code>list_features()</code> and
<code>list_feature_codes()</code>. Either plate-level or well-level dataset references
are passed and whenever plate-level references are passed in combination
with <code>WellPosition</code> object, the corresponding well-level references are
created and used. If for different datasets different sets of features are
available, the union of the features of all datasets is searched for. The
returned object is of type <code>FeatureVectorDataset</code>, which for each entry
contains a <code>FeatureVectorDatasetReference</code> and a set of <code>FeatureVector</code>(s),
one for each well.</p>
    <h2 class="hasAnchor" id="openbis"><a class="anchor" href="#openbis"></a>openBIS</h2>

    

<ul>
<li><p><a href='https://svnsis.ethz.ch/doc/openbis/13.04.0/ch/systemsx/cisd/openbis/dss/screening/shared/api/v1/IDssServiceRpcScreening.html'>IDssServiceRpcScreening:listAvailableFeatures</a></p></li>
</ul>


<ul>
<li><p><a href='https://svnsis.ethz.ch/doc/openbis/13.04.0/ch/systemsx/cisd/openbis/dss/screening/shared/api/v1/IDssServiceRpcScreening.html'>IDssServiceRpcScreening:listAvailableFeatureCodes</a></p></li>
</ul>


<ul>
<li><p><a href='https://svnsis.ethz.ch/doc/openbis/13.04.0/ch/systemsx/cisd/openbis/dss/screening/shared/api/v1/IDssServiceRpcScreening.html'>IDssServiceRpcScreening:loadFeatures</a></p></li>
</ul>


<ul>
<li><p><a href='https://svnsis.ethz.ch/doc/openbis/13.04.0/ch/systemsx/cisd/openbis/dss/screening/shared/api/v1/IDssServiceRpcScreening.html'>IDssServiceRpcScreening:loadFeaturesForDatasetWellReferences</a></p></li>
</ul>

    <h2 class="hasAnchor" id="implementation-note"><a class="anchor" href="#implementation-note"></a>Implementation note</h2>

    <p>Even though there exists a constructor for
<code>FeatureVectorDatasetWellReference</code> objects, which takes two arguments, one
for the corresponding <code>FeatureVectorDatasetReference</code> object and one for
a <code>WellPosition</code> objects, this does not work. Furthermore, class information
cannot be supplied as this will cause an error as well (hence the use of
<code><a href='json_class.html'>rm_json_class()</a></code>). Why the function <code>loadFeaturesForDatasetWellReferences</code>
behaves this way is currently unclear.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other resource listing/downloading functions: <code><a href='list_fetch_images.html'>fetch_images</a></code>,
  <code><a href='list_urls.html'>list_download_urls</a></code>,
  <code><a href='list_fetch_files.html'>list_files</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
  <span class='no'>tok</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='login.html'>login_openbis</a></span>()

  <span class='co'># search for a sample object corresponding to plate KB2-03-1I</span>
  <span class='no'>samp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='search_openbis.html'>search_openbis</a></span>(<span class='no'>tok</span>,
                         <span class='fu'><a href='search_openbis.html'>search_criteria</a></span>(
                           <span class='fu'><a href='search_openbis.html'>attribute_clause</a></span>(<span class='st'>"code"</span>,
                                            <span class='st'>"/INFECTX_PUBLISHED/KB2-03-1I"</span>)
                         ),
                         <span class='kw'>target_object</span> <span class='kw'>=</span> <span class='st'>"sample"</span>)
  <span class='co'># for the plate sample object, list all feature data sets</span>
  <span class='no'>feat_ref</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='list_datasets.html'>list_references</a></span>(<span class='no'>tok</span>, <span class='no'>samp</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"feature"</span>)

  <span class='co'># several data set types can act as feature data sets</span>
  <span class='fu'><a href='json_utils.html'>get_field</a></span>(<span class='no'>feat_ref</span>, <span class='st'>"dataSetType"</span>)</div><div class='output co'>#&gt; [1] "HCS_ANALYSIS_CONTAINER_WELL_CLASSIFICATION_SUMMARIES"   
#&gt; [2] "HCS_ANALYSIS_CONTAINER_WELL_RESULTS_SUMMARIES"          
#&gt; [3] "HCS_ANALYSIS_WELL_THRESHOLDEDINFECTIONSCORING_SUMMARIES"
#&gt; [4] "HCS_ANALYSIS_WELL_THRESHOLDEDINFECTIONSCORING_SUMMARIES"
#&gt; [5] "HCS_ANALYSIS_WELL_THRESHOLDEDINFECTIONSCORING_SUMMARIES"
#&gt; [6] "HCS_ANALYSIS_WELL_THRESHOLDEDINFECTIONSCORING_SUMMARIES"
#&gt; [7] "HCS_ANALYSIS_WELL_RESULTS_SUMMARIES"                    </div><div class='input'>  <span class='no'>feat_ref</span> <span class='kw'>&lt;-</span> <span class='no'>feat_ref</span><span class='kw'>[[</span><span class='fl'>7L</span>]]

  <span class='co'># for a feature data set, list all features</span>
  <span class='no'>feat_info</span> <span class='kw'>&lt;-</span> <span class='fu'>list_features</span>(<span class='no'>tok</span>, <span class='no'>feat_ref</span>)
  <span class='no'>feat_info</span> <span class='kw'>&lt;-</span> <span class='no'>feat_info</span>[<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2L</span>, <span class='fl'>6L</span>)]

  <span class='co'># for a feature data set, a set of feature codes and a set of wells,</span>
  <span class='co'># retrieve the corresponding feature data</span>
  <span class='no'>feats</span> <span class='kw'>&lt;-</span> <span class='fu'>fetch_features</span>(<span class='no'>tok</span>, <span class='no'>feat_ref</span>,
                          <span class='kw'>feature_codes</span> <span class='kw'>=</span> <span class='fu'><a href='json_utils.html'>get_field</a></span>(<span class='no'>feat_info</span>, <span class='st'>"code"</span>),
                          <span class='kw'>wells</span> <span class='kw'>=</span> <span class='fu'><a href='list_plate_well.html'>well_pos</a></span>(<span class='fl'>1</span>:<span class='fl'>6</span>, <span class='fl'>3</span>:<span class='fl'>8</span>))

  <span class='no'>well_pos</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='json_utils.html'>get_field</a></span>(<span class='no'>feats</span>, <span class='st'>"wellPosition"</span>)
  <span class='no'>values</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='json_utils.html'>get_field</a></span>(<span class='no'>feats</span>, <span class='st'>"values"</span>)
  <span class='kw pkg'>tibble</span><span class='kw ns'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span>(
    <span class='kw'>well_row</span> <span class='kw'>=</span> <span class='fu'><a href='json_utils.html'>get_field</a></span>(<span class='no'>well_pos</span>, <span class='st'>"wellRow"</span>),
    <span class='kw'>well_col</span> <span class='kw'>=</span> <span class='fu'><a href='json_utils.html'>get_field</a></span>(<span class='no'>well_pos</span>, <span class='st'>"wellColumn"</span>),
    <span class='kw'>cell_count</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span>(<span class='no'>values</span>[<span class='fl'>1L</span>, ]),
    <span class='kw'>cell_area</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span>(<span class='no'>values</span>[<span class='fl'>2L</span>, ])
  )</div><div class='output co'>#&gt; # A tibble: 6 x 4
#&gt;   well_row well_col cell_count cell_area
#&gt;      &lt;int&gt;    &lt;int&gt;      &lt;int&gt;     &lt;int&gt;
#&gt; 1        1        3       1023      4838
#&gt; 2        2        4       1196      8413
#&gt; 3        3        5       1758      5765
#&gt; 4        4        6       2051      3868
#&gt; 5        5        7       1185      7728
#&gt; 6        6        8        669     12296</div><div class='input'>
  <span class='fu'><a href='login.html'>logout_openbis</a></span>(<span class='no'>tok</span>)
<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#openbis">openBIS</a></li>
      <li><a href="#implementation-note">Implementation note</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='mailto:nicolas.bennett@stat.math.ethz.ch'>Nicolas Bennett</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '8f9990194a308dca43109e01826929af',
    indexName: 'infx',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


