<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JSON object handling • infx</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="JSON object handling">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">infx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/infx-intro.html">Introduction to infx</a>
    </li>
    <li>
      <a href="../articles/json-class.html">JSON object handling</a>
    </li>
    <li>
      <a href="../articles/openbis-api.html">OpenBIS API coverage</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>JSON object handling</h1>
                        <h4 class="author">Nicolas Bennett</h4>
            
            <h4 class="date">2019-12-05</h4>
      
      
      <div class="hidden name"><code>json-class.Rmd</code></div>

    </div>

    
    
<p>The openBIS JSON-RPC API is powered by the Jackson JSON processor on the server side. As such, object type information is communicated via <code>@type</code> fields. Take as an example the class <code>Dog</code> defined as</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">public</span> <span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span> Dog {</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  <span class="kw">private</span> <span class="bu">String</span> name;</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  <span class="kw">private</span> <span class="bu">String</span> breed;</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="co">// setters and getters</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">}</a></code></pre></div>
<p>An instance of <code>Dog</code> can be represented as the following JSON object</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="dt">"@type"</span><span class="fu">:</span> <span class="st">"Dog"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"Rufus"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">"breed"</span><span class="fu">:</span> <span class="st">"english shepherd"</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="fu">}</span></a></code></pre></div>
<p>where the <code>@type</code> filed is used by the deserializer to infer what java object should result. Furthermore, on the client side, class information is used for S3 method dispatch. This document will illustrate how typed JSON objects returned by openBIS are converted into S3 classes, how these classes can be manipulated in R and subsequently used for further openBIS queries.</p>
<div id="creating-json_class-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-json_class-objects" class="anchor"></a>Creating <code>json_class</code> objects</h2>
<p>Again a feature of the Jackson serializer, <code>@id</code> fields are generated for all objects by an <code>ObjectIdGenerator</code> (an <code>IntSequenceGenerator</code> to be more specific), which can be used to represent relationships among objects. These object ids are employed whenever the same object is returned multiple times. This happens for example when several objects representing wells on the same plate are returned. The first <code>WellIdentifier</code> object will contain a <code>PlateIdentifier</code> object and all subsequent wells identify their parent plate via a reference to this <code>PlateIdentifier</code> object. A simplified example, demonstrating this structure is shown below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">response &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">`</span><span class="dt">@type</span><span class="st">`</span> =<span class="st"> "WellIdentifier"</span>,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                      <span class="st">`</span><span class="dt">@id</span><span class="st">`</span> =<span class="st"> </span>1L,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                      <span class="dt">row =</span> <span class="st">"A"</span>,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                      <span class="dt">col =</span> 1L,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">                      <span class="dt">plate =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">`</span><span class="dt">@type</span><span class="st">`</span> =<span class="st"> "PlateIdentifier"</span>,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">                                   <span class="st">`</span><span class="dt">@id</span><span class="st">`</span> =<span class="st"> </span>2L,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">                                   <span class="dt">barcode =</span> <span class="st">"abcd-123"</span>)),</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">                 <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">`</span><span class="dt">@type</span><span class="st">`</span> =<span class="st"> "WellIdentifier"</span>,</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">                      <span class="st">`</span><span class="dt">@id</span><span class="st">`</span> =<span class="st"> </span>3L,</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">                      <span class="dt">row =</span> <span class="st">"A"</span>,</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">                      <span class="dt">col =</span> 2L,</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">                      <span class="dt">plate =</span> 2L))</a></code></pre></div>
<p>Turning the list <code>response</code> into a <code>json_class</code> S3 class can be done, using the function <code><a href="../reference/json_class.html">as_json_class()</a></code> (or its alias <code><a href="../reference/json_class.html">as.json_class()</a></code>). This action is applied recursively, meaning that all sub-lists, containing an <code>@type</code> field are turned into <code>json_class</code> objects as well.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">json_class &lt;-<span class="st"> </span><span class="kw"><a href="../reference/json_class.html">as_json_class</a></span>(response)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(json_class)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; List of 2</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;  $ :List of 4</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt;   ..$ @id  : int 1</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;   ..$ row  : chr "A"</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;   ..$ col  : int 1</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;   ..$ plate:List of 2</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;   .. ..$ @id    : int 2</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;   .. ..$ barcode: chr "abcd-123"</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;   .. ..- attr(*, "class")= chr [1:2] "PlateIdentifier" "json_class"</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;   ..- attr(*, "class")= chr [1:2] "WellIdentifier" "json_class"</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;  $ :List of 4</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;   ..$ @id  : int 3</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt;   ..$ row  : chr "A"</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt;   ..$ col  : int 2</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;   ..$ plate: int 2</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;   ..- attr(*, "class")= chr [1:2] "WellIdentifier" "json_class"</span></a></code></pre></div>
<p>In order to resolve object references encoded by <code>@id</code> fields, the function <code><a href="../reference/request.html">resolve_references()</a></code>, which also acts recursively on its input, can be used. This will duplicate all occurrences of referenced objects, introducing a memory penalty, but in turn making objects self-contained. After resolving references, the list of well objects can be subsetted and the second <code>WellIdentifier</code> object can be used for a further query on its own.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">json_class &lt;-<span class="st"> </span><span class="kw"><a href="../reference/request.html">resolve_references</a></span>(json_class)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(json_class)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; List of 2</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt;  $ :List of 3</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt;   ..$ row  : chr "A"</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt;   ..$ col  : int 1</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;   ..$ plate:List of 1</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;   .. ..$ barcode: chr "abcd-123"</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;   .. ..- attr(*, "class")= chr [1:2] "PlateIdentifier" "json_class"</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;   ..- attr(*, "class")= chr [1:2] "WellIdentifier" "json_class"</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;  $ :List of 3</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;   ..$ row  : chr "A"</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;   ..$ col  : int 2</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt;   ..$ plate:List of 1</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;   .. ..$ barcode: chr "abcd-123"</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt;   .. ..- attr(*, "class")= chr [1:2] "PlateIdentifier" "json_class"</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;   ..- attr(*, "class")= chr [1:2] "WellIdentifier" "json_class"</span></a></code></pre></div>
<p>In case the user wants to create a <code>json_class</code> object, the constructor <code><a href="../reference/json_class.html">json_class()</a></code> is available. It can be used as follows, e.g. for the re-creation of the above <code>json_class</code> object.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">construct &lt;-<span class="st"> </span><span class="kw"><a href="../reference/json_class.html">json_class</a></span>(<span class="dt">row =</span> <span class="st">"A"</span>, <span class="dt">col =</span> 1L,</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">                        <span class="dt">plate =</span> <span class="kw"><a href="../reference/json_class.html">json_class</a></span>(<span class="dt">barcode =</span> <span class="st">"abcd-123"</span>,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                                           <span class="dt">class =</span> <span class="st">"PlateIdentifier"</span>),</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                        <span class="dt">class =</span> <span class="st">"WellIdentifier"</span>)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(construct, json_class[[1L]])</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>The effect of <code><a href="../reference/json_class.html">as_json_class()</a></code> can be reversed by <code><a href="../reference/json_class.html">rm_json_class()</a></code> or <code><a href="../reference/json_base.html">as_list()</a></code> (as well as its alias <code><a href="https://rdrr.io/r/base/list.html">as.list()</a></code>). The two functions differ in default behavior however. Where <code><a href="../reference/json_class.html">rm_json_class()</a></code> removes S3 classes and writes class information into the respective <code>@type</code> fields, <code><a href="../reference/json_base.html">as_list()</a></code>, by default simple returns its input. This somewhat odd choice is owed to the circumstance that iterating though a <code>json_class</code> object with <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code> or <code><a href="https://rdrr.io/r/base/lapply.html">sapply()</a></code> calls <code><a href="https://rdrr.io/r/base/list.html">as.list()</a></code> on its first argument.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(response,</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">          <span class="kw"><a href="../reference/json_class.html">rm_json_class</a></span>(json_class))</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">as.list</a></span>(json_class, <span class="dt">keep_asis =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">          <span class="kw"><a href="../reference/json_class.html">rm_json_class</a></span>(json_class))</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>In addition to functions for creating and destroying <code>json_class</code> objects, several utility functions for <code>json_class</code> are provided as well. <code><a href="../reference/json_class.html">is_json_class()</a></code> (and its alias <code><a href="../reference/json_class.html">is.json_class()</a></code>) tests whether the object in question is a list inheriting the class attribute <code>json_class</code> and has at least one more class attribute in front of <code>json_class</code>, which is expected in last place (within the class vector). Similarly, <code><a href="../reference/json_class.html">check_json_class()</a></code> can be used to recursively test a list structure to make sure that every node inheriting the <code>json_class</code> class attribute is a properly formed <code>json_class</code> object. Finally, the two functions <code><a href="../reference/json_utils.html">get_subclass()</a></code> and <code><a href="../reference/json_utils.html">has_subclass()</a></code> can be used to extract the sub-class and test whether a given <code>json_class</code> object has a specific sub-class.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">test &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/structure.html">structure</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">a =</span> <span class="kw"><a href="https://rdrr.io/r/base/structure.html">structure</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">b =</span> <span class="st">"c"</span>),</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                                     <span class="dt">class =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"foo"</span>, <span class="st">"json_class"</span>)),</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">                       <span class="dt">d =</span> <span class="kw"><a href="https://rdrr.io/r/base/structure.html">structure</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">e =</span> <span class="st">"f"</span>),</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">                                     <span class="dt">class =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"bar"</span>, <span class="st">"json_class"</span>))),</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">                  <span class="dt">class =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"foobar"</span>, <span class="st">"json_class"</span>))</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="kw"><a href="../reference/json_class.html">is_json_class</a></span>(test)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="kw"><a href="../reference/json_class.html">check_json_class</a></span>(test)</a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="kw"><a href="../reference/json_class.html">is_json_class</a></span>(test<span class="op">$</span>a)</a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="kw"><a href="../reference/json_class.html">is_json_class</a></span>(test<span class="op">$</span>d)</a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="kw"><a href="../reference/json_utils.html">has_subclass</a></span>(test, <span class="st">"foobar"</span>)</a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="kw"><a href="../reference/json_utils.html">get_subclass</a></span>(test)</a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; [1] "foobar"</span></a></code></pre></div>
<p>In the above example, <code><a href="../reference/json_class.html">is_json_class(test$d)</a></code> returns <code>FALSE</code> because it is an object that is not composed as a list with attributes, but as a vector with attributes. This is also the reason why the recursive execution of <code><a href="../reference/json_class.html">is_json_class()</a></code> to all contained objects that inherit from <code>json_class</code> in <code><a href="../reference/json_class.html">check_json_class(test)</a></code> returns <code>FALSE</code>.</p>
<p>The two base R generic functions <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> and <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> have <code>json_class</code>-specific methods implemented. Combining several <code>json_class</code> object, using <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> will yield a <code>json_vec</code> object, which is described in the following section. Printing is recursive and recursion depth can be controlled using the argument <code>depth</code>. Further printing options are <code>width</code>, <code>length</code> and a logical flag <code>fancy</code> for enabling fancy printing (console output is colored and UTF box characters are used for creating a tree structure instead of ASCII characters).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">json_class[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; █─WellIdentifier </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; ├─row = A </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; ├─col = 1 </span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; └─plate = █─PlateIdentifier </span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt;           └─...</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(json_class[[<span class="dv">1</span>]], <span class="dt">depth =</span> 2L)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; █─WellIdentifier </span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; ├─row = A </span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; ├─col = 1 </span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; └─plate = █─PlateIdentifier </span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt;           └─barcode = abcd-123</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(json_class[[<span class="dv">1</span>]], <span class="dt">depth =</span> 2L, <span class="dt">length =</span> 4L)</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt; █─WellIdentifier </span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; ├─row = A </span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; ├─col = 1 </span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(json_class[[<span class="dv">1</span>]], <span class="dt">depth =</span> 2L, <span class="dt">fancy =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; X-WellIdentifier </span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; +-row = A </span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; +-col = 1 </span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt; \-plate = X-PlateIdentifier </span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt;           \-barcode = abcd-123</span></a></code></pre></div>
</div>
<div id="using-vectors-of-json_class-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#using-vectors-of-json_class-objects" class="anchor"></a>Using vectors of <code>json_class</code> objects</h2>
<p>Now that class information of objects fetched from openBIS is available in R, this can be used for method dispatch of S3 generic functions. Assume we have a generic function <code><a href="../reference/list_datasets.html">list_datasets()</a></code>. We could then implement an object-specific method for objects of type <code>sample</code> as <code>list_datasets.sample()</code> and one for objects of type <code>experiment</code> as <code>list_datasets.experiment()</code>. Depending on the class of the object passed to <code><a href="../reference/list_datasets.html">list_datasets()</a></code>, datasets for an experiment or for a sample will be listed.</p>
<p>There is an issue with this approach though: listing for example datasets associated with multiple experiments. A straightforward approach could be simply iterating over the list of experiments and for each one, issuing a separate request to openBIS. A more efficient way of doing this would be to query openBIS with a single list of several experiment objects. This, however defeats S3 method dispatch, as the object on which dispatch occurs is no longer <code>experiment</code> but <code>list</code> (containing several <code>experiment</code>s). To work around this, <code>json_vec</code> objects are used.</p>
<p>The <code>json_vec</code> class wraps around a list of <code>json_class</code> and it serves to bring the common sub-class of all child objects to the surface for using method dispatch on. Instantiation of <code>json_vec</code> objects is possible in several ways: using the <code><a href="../reference/json_vec.html">json_vec()</a></code> constructor, by coercing a list structure with <code><a href="../reference/json_vec.html">as_json_vec()</a></code> or by combining several <code>json_class</code> objects using <code><a href="https://rdrr.io/r/base/c.html">base::c()</a></code>. The reverse action can be performed, using <code><a href="https://rdrr.io/r/base/list.html">base::as.list()</a></code>. The <code>json_vec</code> constructor, as well as functions for coercing to <code>json_vec</code> accept a <code>simplify</code> argument. When set to <code>TRUE</code> (default is <code>FALSE</code>), <code>json_vec</code> objects of length 1 are simplified to <code>json_class</code> objects.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/json_class.html">json_class</a></span>(<span class="st">"a"</span>, <span class="dt">class =</span> <span class="st">"foo"</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/json_class.html">json_class</a></span>(<span class="st">"b"</span>, <span class="dt">class =</span> <span class="st">"foo"</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">foo_vec &lt;-<span class="st"> </span><span class="kw"><a href="../reference/json_vec.html">json_vec</a></span>(a, b)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(foo_vec)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; List of 2</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt;  $ :List of 1</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;   ..$ : chr "a"</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt;   ..- attr(*, "class")= chr [1:2] "foo" "json_class"</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt;  $ :List of 1</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;   ..$ : chr "b"</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;   ..- attr(*, "class")= chr [1:2] "foo" "json_class"</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;  - attr(*, "class")= chr [1:2] "foo" "json_vec"</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(foo_vec, <span class="kw"><a href="../reference/json_vec.html">as_json_vec</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(a, b)))</a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(foo_vec, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(a, b))</a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">as.list</a></span>(foo_vec), <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(a, b))</a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(a, <span class="kw"><a href="../reference/json_vec.html">as_json_vec</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(a), <span class="dt">simplify =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Utility functions available for <code>json_vec</code> objects include <code><a href="../reference/json_vec.html">has_common_subclass()</a></code> and <code><a href="../reference/json_utils.html">get_subclass()</a></code> to check whether all entries in a list are <code>json_class</code> objects with the same sub-class and to extract the common sub-class, as well as <code><a href="../reference/json_vec.html">is_json_vec()</a></code> (and its alias <code><a href="../reference/json_vec.html">is.json_vec()</a></code>), which can be used to check whether</p>
<ul>
<li>all child elements are of the same sub-class</li>
<li>all child elements are properly formed <code>json_class</code> objects</li>
<li>the <code>json_vec</code> class attribute is in last position of the class vector</li>
<li>the remaining class attributes are equal to the common sub-class of the children.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/json_vec.html">has_common_subclass</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(a, b))</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="kw"><a href="../reference/json_utils.html">get_subclass</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(a, b))</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; [1] "foo"</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="kw"><a href="../reference/json_utils.html">get_subclass</a></span>(foo_vec)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; [1] "foo"</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="kw"><a href="../reference/json_vec.html">is_json_vec</a></span>(foo_vec)</a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="kw"><a href="../reference/json_vec.html">is_json_vec</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(a, b))</a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>Finally, the base R generics for which <code>json_vec</code>-specific methods are provided include <code><a href="https://rdrr.io/r/base/print.html">print()</a></code>, <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>, as well as accessors and assignment functions.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">foo_vec</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; ┌─█─foo </span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; │ └─a </span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; └─█─foo </span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt;   └─b</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">foo_vec[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; ──█─foo </span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt;   └─a</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(foo_vec[<span class="dv">2</span>], foo_vec[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; ┌─█─foo </span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; │ └─b </span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; └─█─foo </span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt;   └─a</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(foo_vec[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt; [1] "foo"      "json_vec"</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(foo_vec[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt; [1] "foo"        "json_class"</span></a></code></pre></div>
<p>As shown in the above code block, subsetting a <code>json_vec</code> object preserves all class attributes. This is in analogy to base vector objects, where subsetting, for example a character vector again yields a character vector. The single element accessor <code><a href="https://rdrr.io/r/base/Extract.html">[[</a></code>, however yields an element of the <code>json_vec</code> object, which should not come as surprise given the list nature of <code>json_vec</code> objects.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#creating-json_class-objects">Creating <code>json_class</code> objects</a></li>
      <li><a href="#using-vectors-of-json_class-objects">Using vectors of <code>json_class</code> objects</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="mailto:nicolas.bennett@stat.math.ethz.ch">Nicolas Bennett</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '8f9990194a308dca43109e01826929af',
    indexName: 'infx',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
